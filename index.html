<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body, html {
margin: 0;
padding: 0;
width: 100%;
height: 100%;
overflow: hidden;
}
canvas {
display: block;
width: 100%;
height: 100%;
}
#mainMenu {
position: absolute;
top: 0;
left: 0;
width: 100%;
height: 100%;
background-color: white;
display: flex;
flex-direction: column;
justify-content: center;
align-items: center;
}
#playButton {
padding: 10px 20px;
font-size: 24px;
border: none;
background-color: #4CAF50;
color: white;
cursor: pointer;
}
#score {
position: absolute;
bottom: 10px;
right: 10px;
font-size: 18px;
}
</style>
</head>
<body>
<canvas id="gameCanvas"></canvas>
<div id="mainMenu">
<h1>Roman.io</h1>
<button id="playButton">Играть</button>
</div>
<div id="score">Score: <span id="scoreValue">0</span></div>
<script>
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");
const mainMenu = document.getElementById("mainMenu");
const playButton = document.getElementById("playButton");
const scoreElement = document.getElementById("scoreValue");

let inMainMenu = true;
let score = 0;

// Set canvas size to window size
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

// Initialize the big ball (player)
const player = {
x: canvas.width / 2,
y: canvas.height / 2,
radius: 30,
color: "blue",
borderColor: "darkblue" // Added border color
};

// Initialize the bot
const bot = {
x: Math.random() * canvas.width,
y: Math.random() * canvas.height,
radius: 30,
color: "red",
};

// Initialize an array of small balls
const smallBalls = [];

// Images
const ballImage = new Image();
ballImage.src = "nepivo.png"; // Replace "nepivo.png" with the path to your image

// Function to create a small ball
function createSmallBall() {
    // Calculate random angle
    const angle = Math.random() * Math.PI * 2;
    
    // Calculate distance from player for the small ball to appear
    const distance = player.radius + 20; // Change 20 to adjust distance
    
    // Calculate initial coordinates for the small ball
    const x = player.x + Math.cos(angle) * distance;
    const y = player.y + Math.sin(angle) * distance;

    const ball = {
        x,
        y,
        radius: 10,
    };
    smallBalls.push(ball);
}

// Event listener for window resize
window.addEventListener("resize", () => {
// Resize canvas to fit window
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;
});

// Event listener for mouse movement
canvas.addEventListener("mousemove", (e) => {
if (!inMainMenu) {
player.x = e.clientX;
player.y = e.clientY;
}
});

// Event listener for play button
playButton.addEventListener("click", () => {
mainMenu.style.display = "none";
inMainMenu = false;
});

// Event listener for key press (W)
window.addEventListener("keydown", (e) => {
if (e.key === "w" && player.radius > 10) {
player.radius -= 5; // Decrease player size
createSmallBall(); // Create a small ball
}
});

// Function to move the bot towards the player
function moveBot() {
const dx = player.x - bot.x;
const dy = player.y - bot.y;
const angle = Math.atan2(dy, dx);
const speed = 1;
bot.x += Math.cos(angle) * speed;
bot.y += Math.sin(angle) * speed;
}

// Function to reset the game
function resetGame() {
player.radius = 30;
player.x = canvas.width / 2;
player.y = canvas.height / 2;
bot.radius = 30;
bot.x = Math.random() * canvas.width;
bot.y = Math.random() * canvas.height;
smallBalls.length = 0;
inMainMenu = true;
mainMenu.style.display = "flex";
score = 0;
updateScore();
}

// Update score
function updateScore() {
scoreElement.textContent = score;
if (score >= 500) {
alert("Победа!");
resetGame();
}
}

// Animation loop
function animate() {
if (!inMainMenu) {
ctx.clearRect(0, 0, canvas.width, canvas.height);

// Draw grid background
ctx.beginPath();
ctx.strokeStyle = "lightgray"; // Grid color
for (let x = 0; x < canvas.width; x += 50) {
ctx.moveTo(x, 0);
ctx.lineTo(x, canvas.height);
}
for (let y = 0; y < canvas.height; y += 50) {
ctx.moveTo(0, y);
ctx.lineTo(canvas.width, y);
}
ctx.stroke();

// Move the bot towards the player
moveBot();

// Draw the big ball (player) with border
ctx.beginPath();
ctx.arc(player.x, player.y, player.radius, 0, Math.PI * 2);
ctx.fillStyle = player.color;
ctx.fill();
ctx.strokeStyle = player.borderColor; // Border color
ctx.lineWidth = 3; // Border width
ctx.stroke();

// Draw the bot
ctx.beginPath();
ctx.arc(bot.x, bot.y, bot.radius, 0, Math.PI * 2);
ctx.fillStyle = bot.color;
ctx.fill();

// Draw the small balls
smallBalls.forEach((ball) => {
ctx.drawImage(ballImage, ball.x - ball.radius, ball.y - ball.radius, ball.radius * 2, ball.radius * 2);
});

// Check collision between player and small balls
smallBalls.forEach((ball, index) => {
const dx = ball.x - player.x;
const dy = ball.y - player.y;
const distance = Math.sqrt(dx * dx + dy * dy);
if (distance < player.radius + ball.radius) {
// "Eat" the small ball
player.radius += 2;
smallBalls.splice(index, 1);
createSmallBall();
score += 1;
updateScore();
}
});

// Check collision between bot and small balls
smallBalls.forEach((ball, index) => {
const dx = ball.x - bot.x;
const dy = ball.y - bot.y;
const distance = Math.sqrt(dx * dx + dy * dy);
if (distance < bot.radius + ball.radius) {
// "Eat" the small ball
bot.radius += 2;
smallBalls.splice(index, 1);
createSmallBall();
}
});

// Check collision between player and bot
const dx = player.x - bot.x;
const dy = player.y - bot.y;
const distance = Math.sqrt(dx * dx + dy * dy);
if (distance < player.radius + bot.radius) {
// Player is eaten by the bot
if (bot.radius > player.radius) {
alert("Поражение!");
resetGame();
}
}

// Generate new small balls gradually
if (Math.random() < 0.01) { // Adjust this probability as needed for desired frequency
createSmallBall();
}
}

requestAnimationFrame(animate);
}

// Start the animation loop
animate();
</script>
</body>
</html>
